# Prometheus Configuration for Kong LLM Gateway
#
# Local development configuration
# Alerting is handled by Datadog (not AlertManager)
# For production, use Prometheus Operator with ServiceMonitors

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    environment: local
    project: kong-llm-gateway

# Remote write to Datadog (optional - enable if using Datadog metrics)
# Requires DD_API_KEY environment variable
# remote_write:
#   - url: "https://prometheus-intake.datadoghq.com/api/v1/push"
#     bearer_token: "${DD_API_KEY}"
#     write_relabel_configs:
#       - source_labels: [__name__]
#         regex: "kong_.*"
#         action: keep

# Scrape configurations
scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Kong Gateway metrics
  - job_name: 'kong'
    static_configs:
      - targets: ['kong:8100']
    metrics_path: /metrics
    scrape_interval: 10s
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'kong-gateway'

  # Kong Admin API (if enabled)
  - job_name: 'kong-admin'
    static_configs:
      - targets: ['kong:8001']
    metrics_path: /metrics
    scrape_interval: 30s

  # Mock Bedrock server (local only)
  - job_name: 'mock-bedrock'
    static_configs:
      - targets: ['mock-bedrock:3000']
    metrics_path: /metrics
    scrape_interval: 30s

  # Node exporter (if running)
  - job_name: 'node'
    static_configs:
      - targets: ['node-exporter:9100']
    scrape_interval: 15s

  # Docker containers (if using cAdvisor)
  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']
    scrape_interval: 15s
