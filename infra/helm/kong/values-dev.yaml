# Kong Gateway Helm Values - Development Environment
#
# Inherits from values-base.yaml
# Usage: helm upgrade --install kong kong/kong -f values-base.yaml -f values-dev.yaml

# Enable admin API for development debugging
admin:
  enabled: true
  type: ClusterIP
  http:
    enabled: true
    containerPort: 8001
    servicePort: 8001

# Development logging
env:
  log_level: "debug"

# Proxy service - internal LB for dev
proxy:
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: nlb
    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing
    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip

# Service account with IRSA
serviceAccount:
  create: true
  name: kong
  annotations: {}
  # IRSA annotation will be added during deployment:
  # eks.amazonaws.com/role-arn: <kong_role_arn>

# Reduced resources for dev environment
resources:
  requests:
    cpu: 250m
    memory: 256Mi
  limits:
    cpu: 1000m
    memory: 1Gi

# Single replica for dev (no autoscaling)
replicaCount: 1

autoscaling:
  enabled: false

# No PDB for dev
podDisruptionBudget:
  enabled: false

# Dev tolerations - allow scheduling on spot instances
tolerations:
  - key: "kubernetes.io/arch"
    operator: "Equal"
    value: "amd64"
    effect: "NoSchedule"

# Extra environment variables for dev
extraEnvVars:
  - name: KONG_NGINX_WORKER_PROCESSES
    value: "1"
